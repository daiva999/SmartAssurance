<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller = function($scope, $window) {
   
    var c = this;
    c.sum = 0;
    $scope.travelFrom = "India";
    c.element = [];
    c.prices = [];

    c.user = $scope.data.user;

    var obj = sessionStorage.getItem(c.user);
    var job = JSON.parse(obj);
    var Key = c.data.userId;
    var session = sessionStorage.getItem(Key);
    $scope.pay = JSON.parse(session);
    if (job) {
        $scope.firstName = job.firstName;
        $scope.lastName = job.lastName;
        $scope.dob = job.dob.substring(0, 10);
        $scope.Contact = job.Contact;
        $scope.Passport = job.Passport.substring(0, 10);
        $scope.Passports = job.Passports;
        $scope.Email = job.email;
    }
    var a = {
        "first": job.firstName,
        "last": job.lastName,
    }
    var name = "aj";
    sessionStorage.setItem(name, JSON.stringify((a)));
    var sessionKey = 'abc';
    var sessionDetails = sessionStorage.getItem(sessionKey);
    var jobj = JSON.parse(sessionDetails);

    if (jobj) {
        $scope.visaCentre = jobj.visaCentre;
        $scope.appointmentCategory = jobj.appointmentCategory;
        $scope.subCategory = jobj.subCategory;
    }
   




    if ($scope.pay) {
        $scope.amount = $scope.pay.amount;
        $scope.travelRegion = $scope.pay.userdetails.travelRegion;
        $scope.prodCode = $scope.pay.prodName;
        $scope.insurer = $scope.pay.insurerName;
        $scope.persons = $scope.pay.userdetails.numberOfPersons;
    }
  
    $scope.Services = sessionStorage.getItem("Services");
    $scope.services = JSON.parse($scope.Services); 
    $scope.services.forEach(function(ele) {

        for (var key in ele) {

            c.sum += ele[key];


            var elements = key.split('_').join(' ');

            c.element.push(elements);
            c.prices.push(ele[key]);
        }




    });
    var arr = [];



    $scope.getKeys = function(obj) {
       
        return Object.keys(obj).filter(function(k) {
            return k !== "$$hashKey";
        });

    };
    if ($scope.pay) {
        $scope.sum1 = c.sum + $scope.amount + 1000;
    } else {
        $scope.sum1 = c.sum + 1000;
    }
    var session1 = JSON.parse(sessionStorage.getItem('appointmentTime'));
    if (session1) {
        $scope.date = session1.date;
        $scope.time = session1.time;

    }

    $scope.Updates = function() {
        var ob = {
            "firstName": job.firstName,
            "lastName": job.lastName,
            "dob": job.dob.substring(0, 10),
            "Contact": job.Contact,
            "Passport": job.Passport.substring(0, 10),
            "Passports": job.Passports,
            "Email": job.email,
            "PremiumAmount": $scope.pay.premiumAmount
        };

        var ab = {
            "visaCentre": jobj.visaCentre,
            "appointmentCategory": jobj.appointmentCategory,
            "subCategory": jobj.subCategory,
            "time": session1.date,
            "date": session1.time

        };
        $scope.server.get({
            "action": "storingData1",
            "data": ob,
            "data1": ab
        }).then(function(response) {});


    };
};]]></client_script>
        <controller_as>c</controller_as>
        <css>body {&#13;
  font-family: Arial, sans-serif;&#13;
   border: 1px solid #ccc;&#13;
  border-radius: 5px;&#13;
}&#13;
 &#13;
.form-container {&#13;
  max-width: 600px;&#13;
  margin: 0 auto;&#13;
   padding: 20px;&#13;
  border: 5px solid #ccc;&#13;
  border-radius: 5px;&#13;
}&#13;
 &#13;
.section {&#13;
  margin-bottom: 20px;&#13;
  padding: 20px;&#13;
  border: 3px solid #ccc;&#13;
  border-radius: 5px;&#13;
}&#13;
 &#13;
h2 {&#13;
  margin-bottom: 10px;&#13;
 &#13;
}&#13;
 &#13;
.info1{&#13;
  display: grid;&#13;
  grid-template-columns: 150px 1fr;&#13;
  gap: 10px;&#13;
 &#13;
  &#13;
}&#13;
 &#13;
 &#13;
.info1 div {&#13;
  font-weight: bold;&#13;
 &#13;
}&#13;
 &#13;
.submit-button {&#13;
  padding: 10px 20px;&#13;
  border: none;&#13;
  background-color: #e86020;&#13;
  border-radius : 10px;&#13;
  color: #fff;&#13;
  font-size: 16px;&#13;
  cursor: pointer;&#13;
}&#13;
 &#13;
input[type="checkbox"] {&#13;
  margin-right: 5px;&#13;
}&#13;
 &#13;
.btn.btn-danger {&#13;
  margin-left: 140px;&#13;
}&#13;
.section {&#13;
  border: 1px solid #ddd; &#13;
  padding: 20px;&#13;
}&#13;
.table {&#13;
  display: flex;&#13;
  flex-direction: column;&#13;
   padding:0px;&#13;
}&#13;
&#13;
.row {&#13;
  display: flex;&#13;
  justify-content: space-between;&#13;
&#13;
  padding:20px;&#13;
}&#13;
&#13;
.row.heading {&#13;
  font-weight: bold;&#13;
   padding:20px;&#13;
  padding: 0px;&#13;
}&#13;
&#13;
.row &gt; div {&#13;
  flex: 1;&#13;
  width:100%;&#13;
  text-align: center;&#13;
  padding: 5px;&#13;
  border: none; &#13;
}&#13;
 .line {&#13;
      display: inline-flex;&#13;
      justify-content: space-between;&#13;
      align-items: center;&#13;
    background-color: #d3d3d3;&#13;
      color: black; &#13;
      padding: 10px;&#13;
   width:100%;&#13;
    }&#13;
&#13;
    .line div {&#13;
      flex: 1;&#13;
      text-align: center;&#13;
    }&#13;
&#13;
    .line .inr {&#13;
      text-align: right;&#13;
    }&#13;
&#13;
</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>review</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>review</name>
        <option_schema/>
        <public>true</public>
        <roles/>
        <script><![CDATA[(function() {
	/* populate the 'data' object */
	/* e.g., data.table = $sp.getValue('table'); */
	data.user = gs.getUserName();

	data.userId = gs.getUserID();



	if(input && input.action =="storingData1"){
		//	gs.addErrorMessage(input.data.firstName);
		var gr = new GlideRecord('x_rptp_insureme_appointment_details');
		gr.query();
		if (gr) {
			gr.initialize();

			gr.applicant_name= input.data.firstName +' '+ input.data.lastName;
			gr.d_o_b= input.data.dob;
			gr.passport_exp_date= input.data.Passport;
			gr.passport_no = input.data.Passports;
			gr.contact= input.data.Contact;
			gr.email = input.data.Email;
			gr.choose_your_visa_application_centre = input.data1.visaCentre;
			gr.choose_your_appointment_category = input.data1.appointmentCategory;
			gr.choose_your_sub_category = input.data1.subCategory;
			//		gr.u_premium_amount = input.data.PremiumAmount;
			gr.primary_email = input.data.Email;
			gr.primary_user = input.data.firstName+ ''+input.data.lastName;
			gr.date =new GlideDate();

			gr.insert();

		}
	}



})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>Surya.Prathap</sys_created_by>
        <sys_created_on>2024-02-08 10:53:04</sys_created_on>
        <sys_id>357e91e4939c4a10acdc3f484dba1074</sys_id>
        <sys_mod_count>813</sys_mod_count>
        <sys_name>review</sys_name>
        <sys_package display_value="SmartAssurance" source="x_rptp_insureme">87b3cc0b4775711055784a02516d4350</sys_package>
        <sys_policy/>
        <sys_scope display_value="SmartAssurance">87b3cc0b4775711055784a02516d4350</sys_scope>
        <sys_update_name>sp_widget_357e91e4939c4a10acdc3f484dba1074</sys_update_name>
        <sys_updated_by>Surya.Prathap</sys_updated_by>
        <sys_updated_on>2024-03-04 06:33:05</sys_updated_on>
        <template><![CDATA[<div>
  <div class="form-container">
    <section class="section">
      <h1>Applicant details</h1>
      <div class="info">
        <div>Country of residence</div>
        <div>
          <h4>
            {{travelFrom}}

          </h4>
        </div>
        <hr>
        <div>Travelling to</div>
        <div>
          <h4>Germany</h4>
        </div>
        <hr>
        <div>Visa Application Centre</div>
        <div>
          <h4>{{visaCentre}}</h4>
        </div>
        <hr>
        <div>Appointment Category</div>
        <div>
          <h4>{{appointmentCategory}}</h4>
        </div>
        <hr>

        <div>Appointment Sub Category </div>
        <div>
          <h4>{{subCategory}}</h4>
        </div>

      </div>
    </section>


    <section class="section">
      
      <h1>Your details</h1>
      <div class="info1">
        <div>Applicant</div>
        <div style="margin-left: 50px;"> {{firstName}} {{lastName}}
        </div>
        <div>Date Of Birth</div>
        <div style="margin-left: 50px;">{{dob}}</div>
        <div>Passport Number</div>
        <div style="margin-left: 50px;">{{Passports}}</div>
        <div>Passport Expiry Date</div>
        <div style="margin-left: 50px;">{{Passport}}</div>
        <div>Contact Phone</div>
        <div style="margin-left: 50px;">{{Contact}}</div>
        <div>Email</div>
        <div style="margin-left: 50px;">{{Email}}</div>
      </div>
    </section>

    <section class="section">
      <h1>Appointment details</h1>
      <div class="info">
        <div>
          <h4>Appointment type</h4>
        </div>
        <div>
          <h4>
            Standard
          </h4>
        </div>
        <hr>
        <div>Date</div>
        <div>
          <h4>
           {{date}}
          </h4>
        </div>
        <hr>
        <div>Time</div>
        <div>
          <h4>
            {{time}}</h4>
        </div>
      </div>
    </section>
    <section class="section">
    <h2>Services</h2>
    <div class="table">
        <div class="row heading" ng-repeat="item in c.element">
            <div>
                <h4>{{ item }}</h4>
            </div>
            <div>
                <h4>1 unit</h4>
            </div>
            <div>
                <h4>INR. {{ c.prices[$index] }}/-</h4>
            </div>
        </div>
    
    </div>

    <div class="line">
        <div style="text-align: left;">Sub-Total</div>
        <div class="inr">
            <h4>INR {{ c.sum }}/-</h4>
        </div>
    </div>
</section>

    <section class="section">
      <div style="display: flex; align-items: center;">
        <h2 style="margin-right: 50px;">Fees</h2>
        <span style="text-align: right; margin-left:60%;"><h4>INR 1000/-</h4></span>
      </div>
      <div class="line">
        <div style="text-align: left;">Sub-Total</div>


        <div class="inr"><h4>
          INR 1000/-
          </h4></div>
      </div>
    </section>
    <section class="section">
      <h2>Insurance Fees <a href="https://ven06798.service-now.com/vfsp?id=vfs_get_page"><button type="button"
            class="btn btn-danger">Purchase An Insurance</button></a></h2>
      <hr>

     <div class="table" ng-hide="!amount">
  <table>
    <tr>
      <td>Insurer</td>
      <td>Product Code</td>
       <td>No. of Persons</td>
      <td>Amount</td>
      
    </tr>
    <tr>
      <td>
        <h4>{{insurer}}</h4>
      </td>
      
      <td>
        <h4>{{prodCode}}</h4>
      </td>
      <td>
        <h4>{{persons}}</h4>
      </td>
      <td>
        <h4>{{amount}}</h4>
      </td>
    </tr>
    
  </table>
</div>

      <div class="line" ng-hide= "!amount">
        <div style="text-align: left;">Sub-Total</div>
        <div></div>
        <div class="inr"><h4>
          INR {{amount? + amount +"/-" : ""}}
          </h4></div>
      </div>
    </section>

    <section class="section">
      <h2>Total</h2>
      <div class="line">
        <div style="text-align: left;">Sub-Total</div>
        <div></div>
        <div class="inr"><h4>
          INR {{sum1}}/-
          </h4></div>
      </div>
    </section>
    <section name="myform" class="section">
      <h2>Acceptance<span style="color :red">*</span></h2>
      <div class="info">
        <input type="checkbox" id="terms" name="terms" height=20px widht=20px ng-model="terms_conditions" requiredx>
        <label for="terms">I accept the <a href="javascript:void(0)">Terms and Conditions</a></label><br>
        <input type="checkbox" id="terms1" name="terms1" height=20px widht=20px ng-model="aggred_terms_conditions"
          required /> <label for="communication" style="display:inline">Yes, I agree to receive future communication on
          optional value added services offered by VFS Global</label>

      </div>
    </section>
    <a href="https://ven06798.service-now.com/vfsp?id=login_page2">
      <button ng-if="terms_conditions && aggred_terms_conditions" ng-click="Updates()"
        class="submit-button">Submit</button>
    </a>
  </div>]]></template>
    </sp_widget>
</record_update>
